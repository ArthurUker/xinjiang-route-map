<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>12æœˆåŒ—ç–†å†¬å­£è‡ªé©¾çº¿è·¯å›¾</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            height: 100vh;
            overflow: hidden;
            background: #f5f5f5;
        }
        
        #container {
            width: 100%;
            height: 100%;
        }
        
        .info-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            max-width: 380px;
            max-height: 85vh;
            overflow-y: auto;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .info-panel.collapsed {
            max-height: auto;
            overflow: visible;
        }

        .info-panel.collapsed .collapsible-content {
            display: none;
        }
        
        .info-panel h1 {
            font-size: 22px;
            color: #1a1a1a;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .info-panel .subtitle {
            font-size: 13px;
            color: #666;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .route-summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .route-summary h3 {
            font-size: 14px;
            margin-bottom: 10px;
            opacity: 0.9;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .summary-item {
            font-size: 13px;
        }
        
        .summary-item strong {
            display: block;
            font-size: 18px;
            margin-top: 4px;
        }

        .toggle-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s;
            margin-bottom: 15px;
        }

        .toggle-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .toggle-btn .arrow {
            transition: transform 0.3s;
            font-size: 16px;
        }

        .info-panel.collapsed .toggle-btn .arrow {
            transform: rotate(180deg);
        }

        .view-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .view-btn {
            flex: 1;
            padding: 10px;
            background: #f0f0f0;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            color: #666;
        }

        .view-btn:hover {
            background: #e3f2fd;
            border-color: #2196F3;
        }

        .view-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .budget-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .budget-section h3 {
            font-size: 15px;
            color: #333;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .budget-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: white;
            border-radius: 6px;
            margin-bottom: 8px;
            font-size: 13px;
        }

        .budget-item:last-child {
            margin-bottom: 0;
        }

        .budget-label {
            color: #555;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .budget-value {
            font-weight: 600;
            color: #333;
        }

        .budget-total {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            font-weight: bold;
            margin-top: 10px;
            font-size: 14px;
        }

        .budget-note {
            font-size: 11px;
            color: #666;
            margin-top: 8px;
            line-height: 1.5;
            padding: 8px;
            background: #fff3cd;
            border-radius: 4px;
        }
        
        .day-section {
            margin-bottom: 15px;
            border-left: 3px solid #ddd;
            padding-left: 12px;
            transition: all 0.3s;
        }

        .day-section.active {
            border-left-color: #4CAF50;
            background: #f0f8ff;
            padding: 8px;
            padding-left: 12px;
            border-radius: 0 8px 8px 0;
            margin-left: -8px;
        }
        
        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            cursor: pointer;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 6px;
            transition: all 0.3s;
        }
        
        .day-header:hover {
            background: #e3f2fd;
            transform: translateX(5px);
        }

        .day-section.active .day-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .day-section.active .day-title {
            color: white;
        }

        .day-section.active .day-badge {
            background: white;
            color: #667eea;
        }
        
        .day-title {
            font-weight: 600;
            font-size: 15px;
            color: #333;
        }
        
        .day-badge {
            background: #4CAF50;
            color: white;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 12px;
        }
        
        .route-details {
            margin-top: 8px;
            font-size: 13px;
            color: #666;
            line-height: 1.6;
        }
        
        .route-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 6px 0;
            padding: 6px;
            background: #fff;
            border-radius: 4px;
            border: 1px solid #eee;
        }
        
        .route-icon {
            font-size: 16px;
        }
        
        .road-tag {
            display: inline-block;
            background: #ff9800;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: bold;
            margin: 0 4px;
        }
        
        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin: 15px 0;
            border-radius: 4px;
            font-size: 13px;
            color: #856404;
        }
        
        .warning-box strong {
            display: block;
            margin-bottom: 6px;
            color: #d32f2f;
        }
        
        .legend {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            margin-top: 15px;
        }
        
        .legend h4 {
            font-size: 13px;
            margin-bottom: 8px;
            color: #333;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 6px 0;
            font-size: 12px;
        }
        
        .legend-color {
            width: 20px;
            height: 3px;
            border-radius: 2px;
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px 40px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            z-index: 2000;
            font-size: 16px;
            color: #333;
        }
        
        @media (max-width: 768px) {
            .info-panel {
                max-width: calc(100% - 40px);
                max-height: 60vh;
                font-size: 12px;
            }
        }
        
        .amap-info-content {
            padding: 10px;
        }
    </style>
</head>
<body>
    <div id="loading" class="loading">ğŸ—ºï¸ æ­£åœ¨ç»˜åˆ¶è·¯çº¿...</div>
    <div id="container"></div>

    <div class="info-panel" id="infoPanel">
        <h1>â„ï¸ 12æœˆåŒ—ç–†å†¬å­£è‡ªé©¾</h1>
        <p class="subtitle">ğŸ“… 12æœˆ13æ—¥-21æ—¥ | ğŸ‘¥ 2äºº | ğŸš— SUVæ¨è<br>ç æµ·â†’ä¹Œé²æœ¨é½å¾€è¿”</p>
        
        <div class="route-summary">
            <h3>ğŸ“Š è¡Œç¨‹æ¦‚å†µ</h3>
            <div class="summary-grid">
                <div class="summary-item">
                    æ€»é‡Œç¨‹<strong>2380km</strong>
                </div>
                <div class="summary-item">
                    æ¸¸ç©å¤©æ•°<strong>7å¤©6æ™š</strong>
                </div>
                <div class="summary-item">
                    ä¸»è¦é“è·¯<strong>G30/G216</strong>
                </div>
                <div class="summary-item">
                    é¢„ç®—<strong>14200å…ƒ</strong>
                </div>
            </div>
        </div>

        <div class="view-controls">
            <button class="view-btn active" onclick="showAllRoutes()">
                ğŸ—ºï¸ å…¨éƒ¨è·¯çº¿
            </button>
            <button class="view-btn" onclick="clearAllRoutes()">
                ğŸ§¹ æ¸…ç©ºæ˜¾ç¤º
            </button>
        </div>

        <button class="toggle-btn" onclick="toggleDetails()">
            <span id="toggleText">æŸ¥çœ‹è¯¦ç»†è¡Œç¨‹</span>
            <span class="arrow">â–¼</span>
        </button>

        <div class="collapsible-content">
            <div class="budget-section">
                <h3>ğŸ’° è¯¦ç»†é¢„ç®—æ˜ç»†</h3>
                <div class="budget-item">
                    <span class="budget-label">âœˆï¸ å¾€è¿”æœºç¥¨</span>
                    <span class="budget-value">4000å…ƒ</span>
                </div>
                <div class="budget-item">
                    <span class="budget-label">ğŸš— ç§Ÿè½¦è´¹ç”¨ï¼ˆ7å¤©ï¼‰</span>
                    <span class="budget-value">2800å…ƒ</span>
                </div>
                <div class="budget-item">
                    <span class="budget-label">â›½ æ²¹è´¹ï¼ˆçº¦2400kmï¼‰</span>
                    <span class="budget-value">1800å…ƒ</span>
                </div>
                <div class="budget-item">
                    <span class="budget-label">ğŸ¨ ä½å®¿è´¹ç”¨ï¼ˆ7æ™šï¼‰</span>
                    <span class="budget-value">2100å…ƒ</span>
                </div>
                <div class="budget-item">
                    <span class="budget-label">ğŸ« é—¨ç¥¨è´¹ç”¨</span>
                    <span class="budget-value">1500å…ƒ</span>
                </div>
                <div class="budget-item">
                    <span class="budget-label">ğŸœ é¤é¥®è´¹ç”¨</span>
                    <span class="budget-value">1400å…ƒ</span>
                </div>
                <div class="budget-item">
                    <span class="budget-label">ğŸ›£ï¸ é«˜é€Ÿè¿‡è·¯è´¹</span>
                    <span class="budget-value">400å…ƒ</span>
                </div>
                <div class="budget-item">
                    <span class="budget-label">ğŸ’ å…¶ä»–æ‚è´¹</span>
                    <span class="budget-value">200å…ƒ</span>
                </div>
                <div class="budget-item budget-total">
                    <span class="budget-label">ğŸ’µ æ€»è®¡ï¼ˆ2äººï¼‰</span>
                    <span class="budget-value">14200å…ƒ</span>
                </div>
                <div class="budget-note">
                    ğŸ’¡ <strong>é¢„ç®—è¯´æ˜ï¼š</strong><br>
                    â€¢ æœºç¥¨ï¼šç æµ·â†”ä¹Œé²æœ¨é½å¾€è¿”å«ç¨<br>
                    â€¢ ç§Ÿè½¦ï¼šå››é©±SUVï¼ˆå«å…¨é™©+é›ªåœ°èƒï¼‰<br>
                    â€¢ ä½å®¿ï¼šç»æµå‹é…’åº—æ ‡å‡†é—´<br>
                    â€¢ é—¨ç¥¨ï¼šå¤©æ± 120+å¯å¯æ‰˜æµ·90+å–€çº³æ–¯195+é­”é¬¼åŸ46+èµ›é‡Œæœ¨æ¹–70+åšç‰©é¦†å…è´¹<br>
                    â€¢ é¤é¥®ï¼šäººå‡100å…ƒ/å¤©
                </div>
            </div>

            <div class="warning-box">
                <strong>âš ï¸ å†¬å­£å®‰å…¨æç¤º</strong>
                â€¢ å¿…é¡»ç§Ÿç”¨å››é©±SUV+é›ªåœ°èƒ<br>
                â€¢ ç‹¬åº“å…¬è·¯å†¬å­£å°é—­ï¼Œå·²è°ƒæ•´è·¯çº¿<br>
                â€¢ å–€çº³æ–¯å»ºè®®å‚åŠ å½“åœ°ä¸€æ—¥æ¸¸å›¢<br>
                â€¢ æ³¨æ„è·¯é¢æš—å†°ï¼Œä¿æŒå®‰å…¨è½¦è·
            </div>
            
            <div id="daysList"></div>
            
            <div class="legend">
                <h4>ğŸ—ºï¸ ä½¿ç”¨è¯´æ˜</h4>
                <div style="font-size: 12px; color: #666; line-height: 1.6;">
                    â€¢ ç‚¹å‡»ä»»æ„ä¸€å¤©æŸ¥çœ‹è¯¥å¤©è·¯çº¿<br>
                    â€¢ ç‚¹å‡»"å…¨éƒ¨è·¯çº¿"æ˜¾ç¤ºå®Œæ•´è¡Œç¨‹<br>
                    â€¢ ç‚¹å‡»"æ¸…ç©ºæ˜¾ç¤º"éšè—æ‰€æœ‰è·¯çº¿<br>
                    â€¢ ç‚¹å‡»æ ‡è®°ç‚¹æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
                </div>
            </div>
        </div>
    </div>

    <script src="https://webapi.amap.com/maps?v=2.0&key=3ca8cc9763f49795910439ccf62e51ae&plugin=AMap.Driving"></script>
    <script>
        // è¯¦ç»†è¡Œç¨‹æ•°æ®
        const itinerary = [
            {
                day: "Day 0",
                date: "12æœˆ13æ—¥",
                title: "æŠµè¾¾ä¹Œé²æœ¨é½",
                distance: "0km",
                points: [
                    { name: "ä¹Œé²æœ¨é½åœ°çªå ¡æœºåœº", coord: [87.474244, 43.907103], type: "airport" },
                    { name: "ä¹Œé²æœ¨é½å¸‚åŒºä½å®¿", coord: [87.617733, 43.792818], type: "hotel" }
                ],
                routes: [],
                details: "21:00æŠµè¾¾æœºåœºï¼Œå…¥ä½å¸‚åŒºé…’åº—ä¼‘æ¯",
                color: "#9E9E9E"
            },
            {
                day: "Day 1",
                date: "12æœˆ14æ—¥",
                title: "ä¹Œé²æœ¨é½â†’å¤©æ± â†’å¯Œè•´",
                distance: "470km",
                time: "6.5å°æ—¶",
                points: [
                    { name: "ä¹Œé²æœ¨é½", coord: [87.617733, 43.792818], type: "start" },
                    { name: "å¤©å±±å¤©æ± ", coord: [88.136353, 43.883669], type: "scenic" },
                    { name: "é˜œåº·å¸‚", coord: [87.984458, 44.161883], type: "pass" },
                    { name: "å¯Œè•´å¿", coord: [89.524232, 47.168751], type: "hotel" }
                ],
                routes: [
                    { 
                        path: [
                            [87.617733, 43.792818],
                            [87.7, 43.85],
                            [87.85, 43.88],
                            [88.136353, 43.883669],
                            [88.3, 44.1],
                            [88.5, 44.5],
                            [88.8, 45.2],
                            [89.0, 46.0],
                            [89.3, 46.8],
                            [89.524232, 47.168751]
                        ],
                        road: "G216"
                    }
                ],
                details: "09:00å–è½¦å‡ºå‘ â†’ 10:30å¤©æ± æ¸¸ç©3h â†’ 14:00å‰å¾€å¯Œè•´ â†’ 19:00æŠµè¾¾",
                color: "#FF5722"
            },
            {
                day: "Day 2",
                date: "12æœˆ15æ—¥",
                title: "å¯Œè•´â†’å¯å¯æ‰˜æµ·â†’å¸ƒå°”æ´¥",
                distance: "330km",
                time: "5å°æ—¶",
                points: [
                    { name: "å¯Œè•´å¿", coord: [89.524232, 47.168751], type: "start" },
                    { name: "å¯å¯æ‰˜æµ·", coord: [89.546631, 47.024872], type: "scenic" },
                    { name: "å¸ƒå°”æ´¥å¿", coord: [86.861031, 47.701529], type: "hotel" }
                ],
                routes: [
                    {
                        path: [
                            [89.524232, 47.168751],
                            [89.546631, 47.024872]
                        ],
                        road: "S226"
                    },
                    {
                        path: [
                            [89.546631, 47.024872],
                            [89.3, 47.1],
                            [88.8, 47.3],
                            [88.2, 47.5],
                            [87.5, 47.6],
                            [86.861031, 47.701529]
                        ],
                        road: "G216â†’S227"
                    }
                ],
                details: "09:00å‡ºå‘ â†’ 10:00å¯å¯æ‰˜æµ·æ¸¸ç©4h â†’ 15:00å‰å¾€å¸ƒå°”æ´¥ â†’ 19:00æŠµè¾¾",
                color: "#FF5722"
            },
            {
                day: "Day 3",
                date: "12æœˆ16æ—¥",
                title: "å¸ƒå°”æ´¥â†’å–€çº³æ–¯ä¸€æ—¥æ¸¸",
                distance: "340km",
                time: "å¾€è¿”",
                points: [
                    { name: "å¸ƒå°”æ´¥å¿", coord: [86.861031, 47.701529], type: "start" },
                    { name: "è´¾ç™»å³ª", coord: [87.005736, 48.588425], type: "pass" },
                    { name: "å–€çº³æ–¯", coord: [87.043465, 48.707302], type: "scenic" }
                ],
                routes: [
                    {
                        path: [
                            [86.861031, 47.701529],
                            [86.9, 47.95],
                            [86.95, 48.2],
                            [87.005736, 48.588425],
                            [87.043465, 48.707302]
                        ],
                        road: "S232"
                    },
                    {
                        path: [
                            [87.043465, 48.707302],
                            [87.005736, 48.588425],
                            [86.95, 48.2],
                            [86.9, 47.95],
                            [86.861031, 47.701529]
                        ],
                        road: "S232è¿”å›"
                    }
                ],
                details: "âš ï¸ å»ºè®®æŠ¥å½“åœ°ä¸€æ—¥æ¸¸å›¢ï¼ˆå«è¶Šé‡è½¦+å‘å¯¼ï¼‰ï¼Œå†¬å­£é›ªæ™¯ç»ç¾",
                color: "#2196F3"
            },
            {
                day: "Day 4",
                date: "12æœˆ17æ—¥",
                title: "å¸ƒå°”æ´¥â†’é­”é¬¼åŸâ†’å¥å±¯",
                distance: "380km",
                time: "4.5å°æ—¶",
                points: [
                    { name: "å¸ƒå°”æ´¥å¿", coord: [86.861031, 47.701529], type: "start" },
                    { name: "ä¸–ç•Œé­”é¬¼åŸ", coord: [85.047932, 45.788026], type: "scenic" },
                    { name: "å¥å±¯å¸‚", coord: [84.903267, 44.426529], type: "hotel" }
                ],
                routes: [
                    {
                        path: [
                            [86.861031, 47.701529],
                            [86.5, 47.3],
                            [86.0, 46.8],
                            [85.5, 46.3],
                            [85.047932, 45.788026]
                        ],
                        road: "S319â†’S201"
                    },
                    {
                        path: [
                            [85.047932, 45.788026],
                            [85.0, 45.2],
                            [84.95, 44.8],
                            [84.903267, 44.426529]
                        ],
                        road: "S201â†’G3014"
                    }
                ],
                details: "09:00å‡ºå‘ â†’ 11:30é­”é¬¼åŸæ¸¸ç©2.5h â†’ 15:00å‰å¾€å¥å±¯ â†’ 17:30æŠµè¾¾",
                color: "#2196F3"
            },
            {
                day: "Day 5",
                date: "12æœˆ18æ—¥",
                title: "å¥å±¯â†’èµ›é‡Œæœ¨æ¹–â†’ä¼Šå®",
                distance: "520km",
                time: "7.5å°æ—¶",
                points: [
                    { name: "å¥å±¯å¸‚", coord: [84.903267, 44.426529], type: "start" },
                    { name: "èµ›é‡Œæœ¨æ¹–", coord: [81.151559, 44.596675], type: "scenic" },
                    { name: "éœå°”æœæ–¯å£å²¸", coord: [80.417818, 44.213994], type: "pass" },
                    { name: "ä¼Šå®å¸‚", coord: [81.317946, 43.916823], type: "hotel" }
                ],
                routes: [
                    {
                        path: [
                            [84.903267, 44.426529],
                            [84.5, 44.45],
                            [84.0, 44.48],
                            [83.5, 44.52],
                            [83.0, 44.55],
                            [82.5, 44.58],
                            [82.0, 44.6],
                            [81.5, 44.6],
                            [81.151559, 44.596675]
                        ],
                        road: "G30"
                    },
                    {
                        path: [
                            [81.151559, 44.596675],
                            [81.067891, 44.425533],
                            [80.8, 44.35],
                            [80.5, 44.28],
                            [80.417818, 44.213994],
                            [80.6, 44.1],
                            [80.9, 44.0],
                            [81.317946, 43.916823]
                        ],
                        road: "G30â†’G3016"
                    }
                ],
                details: "08:00å‡ºå‘ â†’ 11:00èµ›é‡Œæœ¨æ¹–æ¸¸ç©3hï¼ˆå†°å°æ¹–é¢ï¼‰ â†’ é€”ç»éœå°”æœæ–¯ â†’ 17:00æŠµè¾¾ä¼Šå®",
                color: "#4CAF50"
            },
            {
                day: "Day 6",
                date: "12æœˆ19æ—¥",
                title: "ä¼Šå®â†’ä¹Œé²æœ¨é½",
                distance: "680km",
                time: "8å°æ—¶",
                points: [
                    { name: "ä¼Šå®å¸‚", coord: [81.317946, 43.916823], type: "start" },
                    { name: "æœå­æ²Ÿå¤§æ¡¥", coord: [81.067891, 44.425533], type: "scenic" },
                    { name: "çŸ³æ²³å­å¸‚", coord: [86.041075, 44.305886], type: "pass" },
                    { name: "ä¹Œé²æœ¨é½", coord: [87.617733, 43.792818], type: "hotel" }
                ],
                routes: [
                    {
                        path: [
                            [81.317946, 43.916823],
                            [81.067891, 44.425533],
                            [81.5, 44.45],
                            [82.0, 44.48],
                            [82.5, 44.5],
                            [83.0, 44.48],
                            [83.5, 44.46],
                            [84.0, 44.44],
                            [84.5, 44.42],
                            [85.0, 44.38],
                            [85.5, 44.35],
                            [86.041075, 44.305886],
                            [86.5, 44.25],
                            [87.0, 44.15],
                            [87.3, 44.0],
                            [87.617733, 43.792818]
                        ],
                        road: "G3016â†’G30"
                    }
                ],
                details: "08:00å‡ºå‘ â†’ é€”ç»æœå­æ²Ÿå¤§æ¡¥æ‹ç…§ â†’ çŸ³æ²³å­åˆé¤ä¼‘æ¯ â†’ 18:00æŠµè¾¾ä¹Œé²æœ¨é½",
                color: "#4CAF50"
            },
            {
                day: "Day 7",
                date: "12æœˆ20æ—¥",
                title: "ä¹Œé²æœ¨é½å¸‚åŒºæ¸¸+è¿˜è½¦",
                distance: "0km",
                points: [
                    { name: "æ–°ç–†åšç‰©é¦†", coord: [87.632087, 43.787763], type: "scenic" },
                    { name: "å›½é™…å¤§å·´æ‰", coord: [87.632308, 43.809074], type: "scenic" },
                    { name: "ä¹Œé²æœ¨é½", coord: [87.617733, 43.792818], type: "hotel" }
                ],
                routes: [],
                details: "09:00åšç‰©é¦† â†’ 14:00å¤§å·´æ‰è´­ç‰© â†’ 17:00è¿˜è½¦ â†’ æœºåœºé™„è¿‘ä½å®¿",
                color: "#9E9E9E"
            }
        ];

        // å­˜å‚¨æ‰€æœ‰è·¯çº¿å’Œæ ‡è®°
        let allPolylines = [];
        let allRouteMarkers = [];
        let allPointMarkers = [];
        let currentActiveDay = null;

        // åˆ‡æ¢è¯¦æƒ…æ˜¾ç¤º
        window.toggleDetails = function() {
            const panel = document.getElementById('infoPanel');
            const toggleText = document.getElementById('toggleText');
            
            panel.classList.toggle('collapsed');
            
            if (panel.classList.contains('collapsed')) {
                toggleText.textContent = 'æŸ¥çœ‹è¯¦ç»†è¡Œç¨‹';
            } else {
                toggleText.textContent = 'æ”¶èµ·è¯¦ç»†è¡Œç¨‹';
            }
        };

        // åˆå§‹åŒ–åœ°å›¾
        const map = new AMap.Map('container', {
            zoom: 6,
            center: [86.5, 45.5],
            mapStyle: 'amap://styles/whitesmoke',
            viewMode: '3D',
            pitch: 35
        });

        // ç»˜åˆ¶æ‰€æœ‰è·¯çº¿
        function drawRoutes() {
            itinerary.forEach((day, dayIndex) => {
                if (day.routes && day.routes.length > 0) {
                    day.routes.forEach((route) => {
                        // ç»˜åˆ¶è·¯çº¿
                        const polyline = new AMap.Polyline({
                            path: route.path,
                            strokeColor: day.color,
                            strokeWeight: 7,
                            strokeOpacity: 0.9,
                            lineJoin: 'round',
                            lineCap: 'round',
                            showDir: true,
                            dirColor: day.color,
                            zIndex: 50
                        });
                        polyline.setMap(map);
                        polyline.dayId = day.day;
                        allPolylines.push(polyline);

                        // æ·»åŠ è·¯çº¿æ ‡ç­¾
                        const midIndex = Math.floor(route.path.length / 2);
                        const midPoint = route.path[midIndex];
                        const routeMarker = new AMap.Marker({
                            position: midPoint,
                            content: `<div style="background: ${day.color}; color: white; padding: 6px 12px; border-radius: 6px; font-size: 13px; white-space: nowrap; box-shadow: 0 3px 10px rgba(0,0,0,0.4); font-weight: bold;">${route.road}</div>`,
                            offset: new AMap.Pixel(-40, -10),
                            zIndex: 100
                        });
                        routeMarker.setMap(map);
                        routeMarker.dayId = day.day;
                        allRouteMarkers.push(routeMarker);
                    });
                }
            });

            // éšè—åŠ è½½æç¤º
            document.getElementById('loading').style.display = 'none';
            
            // è‡ªåŠ¨é€‚é…è§†é‡
            setTimeout(() => {
                map.setFitView(null, false, [150, 100, 150, 100]);
            }, 300);
        }

        // æ˜¾ç¤ºæŒ‡å®šå¤©çš„è·¯çº¿
        window.showDayRoute = function(dayId) {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
            
            // æ›´æ–°æ—¥ç¨‹åˆ—è¡¨é«˜äº®
            document.querySelectorAll('.day-section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelector(`[data-day="${dayId}"]`)?.classList.add('active');

            currentActiveDay = dayId;

            // éšè—æ‰€æœ‰è·¯çº¿å’Œæ ‡è®°
            allPolylines.forEach(polyline => {
                if (polyline.dayId === dayId) {
                    polyline.show();
                    polyline.setOptions({
                        strokeWeight: 8,
                        strokeOpacity: 1,
                        zIndex: 100
                    });
                } else {
                    polyline.setOptions({
                        strokeWeight: 3,
                        strokeOpacity: 0.2,
                        zIndex: 10
                    });
                }
            });

            allRouteMarkers.forEach(marker => {
                if (marker.dayId === dayId) {
                    marker.show();
                } else {
                    marker.hide();
                }
            });

            // å®šä½åˆ°è¯¥å¤©çš„è·¯çº¿
            const day = itinerary.find(d => d.day === dayId);
            if (day && day.points && day.points.length > 0) {
                const bounds = new AMap.Bounds();
                day.points.forEach(point => {
                    bounds.extend(point.coord);
                });
                map.setBounds(bounds, false, [150, 100, 150, 100]);
            }
        };

        // æ˜¾ç¤ºæ‰€æœ‰è·¯çº¿
        window.showAllRoutes = function() {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // æ¸…é™¤æ—¥ç¨‹é«˜äº®
            document.querySelectorAll('.day-section').forEach(section => {
                section.classList.remove('active');
            });

            currentActiveDay = null;

            allPolylines.forEach(polyline => {
                polyline.show();
                polyline.setOptions({
                    strokeWeight: 7,
                    strokeOpacity: 0.9,
                    zIndex: 50
                });
            });

            allRouteMarkers.forEach(marker => {
                marker.show();
            });

            // é€‚é…æ‰€æœ‰è·¯çº¿
            setTimeout(() => {
                map.setFitView(null, false, [150, 100, 150, 100]);
            }, 300);
        };

        // æ¸…ç©ºæ‰€æœ‰è·¯çº¿
        window.clearAllRoutes = function() {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // æ¸…é™¤æ—¥ç¨‹é«˜äº®
            document.querySelectorAll('.day-section').forEach(section => {
                section.classList.remove('active');
            });

            currentActiveDay = null;

            allPolylines.forEach(polyline => {
                polyline.setOptions({
                    strokeWeight: 3,
                    strokeOpacity: 0.15,
                    zIndex: 10
                });
            });

            allRouteMarkers.forEach(marker => {
                marker.hide();
            });
        };

        // æ·»åŠ æ ‡è®°ç‚¹
        let markerIndex = 1;
        const addedLocations = new Set();

        itinerary.forEach((day) => {
            if (day.points) {
                day.points.forEach((point) => {
                    const locationKey = `${point.coord[0]},${point.coord[1]}`;
                    
                    if (!addedLocations.has(locationKey)) {
                        addedLocations.add(locationKey);
                        
                        let iconStyle = '';
                        let labelContent = '';
                        
                        switch(point.type) {
                            case 'airport':
                                iconStyle = 'background: #2196F3; border: 3px solid white;';
                                labelContent = 'âœˆï¸';
                                break;
                            case 'scenic':
                                iconStyle = 'background: #FF5722; border: 3px solid white;';
                                labelContent = markerIndex++;
                                break;
                            case 'hotel':
                                iconStyle = 'background: #4CAF50; border: 3px solid white;';
                                labelContent = 'ğŸ¨';
                                break;
                            case 'pass':
                                iconStyle = 'background: #FFC107; border: 3px solid white;';
                                labelContent = 'ğŸ“';
                                break;
                            default:
                                iconStyle = 'background: #9E9E9E; border: 3px solid white;';
                                labelContent = markerIndex++;
                        }
                        
                        const marker = new AMap.Marker({
                            position: point.coord,
                            title: point.name,
                            zIndex: 200,
                            label: {
                                content: `<div style="${iconStyle} color: white; padding: 8px 12px; border-radius: 50%; font-size: 13px; font-weight: bold; box-shadow: 0 3px 10px rgba(0,0,0,0.4);">${labelContent}</div>`,
                                offset: new AMap.Pixel(-18, -40)
                            }
                        });
                        
                        marker.setMap(map);
                        allPointMarkers.push(marker);
                        
                        // ç‚¹å‡»æ ‡è®°æ˜¾ç¤ºä¿¡æ¯
                        marker.on('click', () => {
                            const dayInfo = itinerary.find(d => 
                                d.points && d.points.some(p => 
                                    p.coord[0] === point.coord[0] && p.coord[1] === point.coord[1]
                                )
                            );
                            
                            let content = `<div class="amap-info-content">
                                <h3 style="margin: 0 0 8px 0; color: #333; font-size: 16px;">${point.name}</h3>`;
                            
                            if (dayInfo) {
                                content += `<p style="margin: 0; color: #666; font-size: 13px; line-height: 1.6;">
                                    <strong>${dayInfo.day}</strong> ${dayInfo.date}<br>
                                    ${dayInfo.title}<br>`;
                                
                                if (dayInfo.distance && dayInfo.distance !== '0km') {
                                    content += `ğŸ“ ${dayInfo.distance} | â±ï¸ ${dayInfo.time}`;
                                }
                                
                                content += `</p>`;
                            }
                            
                            content += `</div>`;
                            
                            const infoWindow = new AMap.InfoWindow({
                                content: content,
                                offset: new AMap.Pixel(0, -30)
                            });
                            infoWindow.open(map, point.coord);
                        });
                    }
                });
            }
        });

        // ç”Ÿæˆä¾§è¾¹æ åˆ—è¡¨
        const daysList = document.getElementById('daysList');
        itinerary.forEach((day) => {
            const section = document.createElement('div');
            section.className = 'day-section';
            section.setAttribute('data-day', day.day);
            
            let routeInfo = '';
            if (day.routes && day.routes.length > 0) {
                day.routes.forEach(route => {
                    routeInfo += `
                        <div class="route-item">
                            <span class="route-icon">ğŸ›£ï¸</span>
                            <span><span class="road-tag">${route.road}</span></span>
                        </div>
                    `;
                });
            }
            
            section.innerHTML = `
                <div class="day-header" onclick="showDayRoute('${day.day}')">
                    <div>
                        <div class="day-title">${day.day} ${day.date}</div>
                        <div style="font-size: 13px; color: #666; margin-top: 4px;">${day.title}</div>
                    </div>
                    <div class="day-badge">${day.distance || 'ä¼‘æ¯'}</div>
                </div>
                <div class="route-details">
                    ${routeInfo}
                    <div style="margin-top: 8px; color: #555;">ğŸ“ ${day.details}</div>
                </div>
            `;
            
            daysList.appendChild(section);
        });

        // å¼€å§‹ç»˜åˆ¶è·¯çº¿
        drawRoutes();

        // é»˜è®¤æ”¶èµ·è¯¦æƒ…
        document.getElementById('infoPanel').classList.add('collapsed');
    </script>
</body>
</html>
